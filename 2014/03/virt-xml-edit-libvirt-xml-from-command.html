<!DOCTYPE html>
<!-- Generated 2021-06-29 18:30:22.826948 -->
<html lang="en">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-142995745-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-142995745-1');
    </script>
    <link rel="canonical" href="https://blog.wikichoon.com/2014/03/virt-xml-edit-libvirt-xml-from-command.html"/>
      <title>virt-xml: Edit libvirt XML from the command line | Cole Robinson</title>
      <meta charset="utf-8" />
      <link href="https://blog.wikichoon.com/theme/minima-main.css" rel="stylesheet" />
      <link href="https://blog.wikichoon.com/theme/coletheme.css" rel="stylesheet" />
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link href="https://blog.wikichoon.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Cole Robinson Full Atom Feed" />
  </head>

  <body id="index" class="archive">
    <header class="site-header">
      <div class="wrapper">
        <a class="site-title" href="https://blog.wikichoon.com">Cole Robinson</a>
        <nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>
          <div class="trigger">
            <a class="page-link" href="https://blog.wikichoon.com">Home</a>
            <a class="page-link" href="https://blog.wikichoon.com/archives.html">Archives</a>
            <a class="page-link" href="https://wikichoon.com">About</a>
          </div>
        </nav>
      </div>
    </header>

    <main id="content" class="page-content">
      <div class="wrapper">
      <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
        <header>
          <h1 class="post-title givemecolor" itemprop="name headline">virt-xml: Edit libvirt XML from the command line</h2>
          <p class="post-meta">
            <time class="dt-published" datetime="2014-03-04T09:00:00-05:00" itemprop="datePublished">Tue 04 March 2014
            </time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Cole Robinson</span>
            </span> • Tags: <a href="https://blog.wikichoon.com/tag/fedora.html">fedora</a> <a href="https://blog.wikichoon.com/tag/virt.html">virt</a>           </p>
        </header>

        <div class="post-content" itemprop="articleBody">
          <p>We shipped a new tool with <a href="https://blog.wikichoon.com/2014/02/virt-manager-100-released.html">virt-manager 1.0.0</a> called <a href="https://www.redhat.com/archives/virt-tools-list/2014-January/msg00179.html">virt-xml</a>. virt-xml uses virt-install's command line options to allow building and editing libvirt domain XML. A few basic examples:</p>
<p>Change the <code>&lt;description&gt;</code> of domain 'example':</p>
<div class="highlight"><pre><span></span><code><span class="err"># virt-xml example --edit --metadata description=&quot;my new description&quot;</span>
</code></pre></div>

<p>Enable the boot device menu for domain 'example':</p>
<div class="highlight"><pre><span></span><code><span class="err"># virt-xml example --edit --boot bootmenu=on</span>
</code></pre></div>

<p>Hotplug host USB device 001.003 to running domain 'fedora19':</p>
<div class="highlight"><pre><span></span><code><span class="err"># virt-xml f19 --add-device --host-device 001.003 --update</span>
</code></pre></div>

<p>The <a href="https://git.fedorahosted.org/cgit/virt-manager.git/tree/man/virt-xml.pod">virt-xml man page</a> also has a comprehensive set of examples.</p>
<p>While I doubt anyone would call it sexy, <code>virt-xml</code> fills a real need in the libvirt ecosystem. Prior to <code>virt-xml</code>, a question like 'how do I change the cache mode for my VM disk' had two possible answers:</p>
<p><strong>1) Use <code>virsh edit</code></strong></p>
<p><code>virsh edit</code> drops you into <code>$EDITOR</code> and allows you to edit the XML manually. Now ignoring the fact that editing XML by hand is a pain, <code>virsh edit</code> requires the user to know the exact XML attribute or property name, and where to put it. And if its in the wrong place or mis-named, in most cases libvirt will happily ignore it with no feedback (this is actually useful at the API level but not very friendly for direct user interaction).</p>
<p>But more than that, have you ever seen what happens when you drop a less than savvy user into <code>vim</code> for the first time? It doesn't end well :) And this happens more than you might expect.</p>
<p><strong>2) Use <code>virt-manager</code></strong></p>
<p>The more newbie friendly option for sure, the UI is intuitive enough that people can usually find the XML bit they want to twiddle... provided it actually exists in <code>virt-manager</code>.</p>
<p>And that's the problem: over time these types of requests put pressure on <code>virt-manager</code> to expose many kind-of-obscure-but-not-so-obscure-that-virsh-edit-is-an-acceptable-answer XML properties in the UI. It was unclear where to draw the line on what should be in the UI and what shouldn't, and we ended up with various UI bits that very few people were actually interacting with.</p>
<p><strong>Enter <code>virt-xml</code></strong></p>
<p>So here's <code>virt-xml</code>, that allows us to easily make these types of XML changes with a single command. This takes the pressure off <code>virt-manager</code>, and provides a friendly middle ground between the GUI and <code>virsh edit</code>. It also greatly simplifies documentation and wiki pages (like Fedora test day test cases).</p>
<p>The CLI API surface is huge compared to <code>virt-manager</code>'s UI. There's no reason that <code>virt-xml</code> can't expand to support every XML property exposed by libvirt. And we've worked on making it trivially easy to to extend the tool to handle new XML options: in many cases, it's only <a href="https://blog.wikichoon.com/2014/03/extending-virt-xml-command-line.html"><strong>3 lines of code</strong></a> to add a new --disk/--network/... sub option, including unit testing, <a href="https://blog.wikichoon.com/2014/02/virt-install-command-line-introspection.html">command line introspection</a>, and <code>virt-install</code> support.</p>
        </div>

        <div id="disqus_thread"></div>
        <script>
          var disqus_config = function () {
            this.page.url = 'https://blog.wikichoon.com/2014/03/virt-xml-edit-libvirt-xml-from-command.html';
            this.page.identifier = 'https://blog.wikichoon.com/2014/03/virt-xml-edit-libvirt-xml-from-command.html';
          };

          (function() {
            var d = document, s = d.createElement('script');
            s.src = 'https://wikichoon-com.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      </article>
      </div>
    </main>

    <footer class="site-footer h-card">
      <div class="wrapper">
        <h2 class="footer-heading">Cole's dev log</h2>
        <div class="footer-col-wrapper">
          <div class="footer-col footer-col-1">
            <ul class="contact-list">
                <li class="p-name">Cole Robinson </li><li><a class="u-email" href="mailto:">aintdiscole@gmail.com</a></li>
            </ul>
          </div>

          <div class="footer-col footer-col-2">
            <ul class="social-media-list">
              <li><a href="https://github.com/crobinso"><svg class="svg-icon"><use xlink:href="https://blog.wikichoon.com/theme/minima-social-icons.svg#github"></use></svg> <span class="username">crobinso</span></a></li>
              <li><a href="https://www.twitter.com/aintdiscole"><svg class="svg-icon"><use xlink:href="https://blog.wikichoon.com/theme/minima-social-icons.svg#twitter"></use></svg> <span class="username">aintdiscole</span></a></li>
              <li><a href="https://www.linkedin.com/in/cole-robinson-484a9912"><svg class="svg-icon"><use xlink:href="https://blog.wikichoon.com/theme/minima-social-icons.svg#linkedin"></use></svg> <span class="username">Cole Robinson</span></a></li>
            </ul>
          </div>

          <div class="footer-col footer-col-3">
            <a href="https://blog.wikichoon.com/feeds/all.atom.xml">RSS</a>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>